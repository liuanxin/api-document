<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>api document</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/jQuery-Validation-Engine/2.6.4/validationEngine.jquery.min.css">
    <style type="text/css">
        html {
            position: relative;
            min-height: 100%;
        }
        body {
            font-size: 16px;
        }
        footer {
            position: absolute;
            height: 133px;
            width: 100%;
            background: #f5f5f5;
        }
        footer > div {
            padding: 10px;
        }
        footer p {
            margin: 5px 0;
            text-align: center;
        }
        input, select {
            min-width: 180px;
            width: 100%;
            min-height: 28px;
        }
        textarea {
            min-height: 120px;
            height: 100%;
            min-width: 180px;
            width: 100%;
        }
        input[type=button] {
            width: 180px;
            height: 32px;
            border: none;
            font-size: 16px;
            color: #fff;
            background-color: #56baed;
            box-shadow: 0 10px 30px 0 rgba(95,186,233,0.4);
            transition: all 0.3s ease-in-out;
        }
        input[type=button]:hover {
            color: #fff;
            background-color: #39ace7;
        }
        input[type=button]:active {
            transform: scale(0.95);
        }
        pre {
            font-size: 14px;
            overflow: auto;
            margin: 0 0 14px;
            padding: 7px 14px;
        }
        pre .line-number {
            color: #2B91AF;
            display: block;
            float: left;
            margin: 0 14px 0 -14px;
            border-right: 1px solid;
            text-align: right;
            padding: 0 7px 0 14px;
        }
        pre .comment {
            color: #998;
            font-style: italic;
        }
        table thead tr th {
            white-space: nowrap;
        }

        .panel {
            overflow: auto;
        }
        .input-group {
            position: unset;
        }
        .module {}
        .module-name {
            border-bottom: 5px solid #eee;
            margin-bottom: -5px;
        }
        .module-api {
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }
        .module-api-index {}
        .module-api-info {}
        .module-api-info-basic {}
        .module-api-info-desc {}
        .module-api-info-param {}
        .module-api-info-return {}
        .bottom-table {
            margin-bottom: 10px;
        }
        .text-left {
            vertical-align: middle !important;
        }
        .response-example {
            color: #337ab7;
            text-decoration: none;
            background-color: transparent;
            cursor: pointer;
        }
        .response-example:focus, .response-example:hover {
            color: #23527c;
            text-decoration: underline;
        }
        .modal-dialog {
            width: 75%;
        }
        .formError {
            white-space: nowrap;
        }
        .example {
            min-width: 200px;
        }
        .curl, .response {
            display: none;
        }
        .bold {
            font-weight: bold !important;
        }
        .wrap {
            white-space: pre-wrap;
        }
        .green {
            color: green !important;
        }
        .red {
            color: red !important;
        }

        .bs-docs-sidebar {
            width: inherit;
            position: fixed;
            margin: 15px 0;
        }
        .bs-docs-sidebar > .nav {
            overflow-y: auto;
            max-height: calc(100vh - 30px); /* 100vh - top - bottom */
        }
        .bs-docs-sidebar .nav > li > a {
            display: block;
            padding: 4px 0 4px 20px;
            font-size: 14px;
            font-weight: 500;
            color: #999;
        }
        .bs-docs-sidebar .nav > li > a:hover,
        .bs-docs-sidebar .nav > li > a:focus {
            padding-left: 19px;
            color: #A1283B;
            text-decoration: none;
            background-color: transparent;
            border-left: 1px solid #A1283B;
        }
        .bs-docs-sidebar .nav > .active > a,
        .bs-docs-sidebar .nav > .active:hover > a,
        .bs-docs-sidebar .nav > .active:focus > a {
            padding-left: 18px;
            font-weight: bold;
            color: #A1283B;
            background-color: transparent;
            border-left: 2px solid #A1283B;
        }
        .bs-docs-sidebar .nav .nav {
            display: none;
            padding-bottom: 10px;
        }
        .bs-docs-sidebar .nav .nav > li > a {
            padding-top: 1px;
            padding-bottom: 1px;
            padding-left: 30px;
            font-size: 12px;
            font-weight: normal;
        }
        .bs-docs-sidebar .nav .nav > li > a:hover,
        .bs-docs-sidebar .nav .nav > li > a:focus {
            padding-left: 29px;
        }
        .bs-docs-sidebar .nav .nav > .active > a,
        .bs-docs-sidebar .nav .nav > .active:hover > a,
        .bs-docs-sidebar .nav .nav > .active:focus > a {
            padding-left: 28px;
            font-weight: 500;
        }
        .bs-docs-sidebar .nav .nav .nav {
            padding-bottom: 10px;
        }
        .bs-docs-sidebar .nav .nav .nav > li > a {
            padding-top: 1px;
            padding-bottom: 1px;
            padding-left: 40px;
            font-size: 12px;
            font-weight: normal;
        }
        .bs-docs-sidebar .nav .nav .nav > li > a:hover,
        .bs-docs-sidebar .nav .nav .nav > li > a:focus {
            padding-left: 39px;
        }
        .bs-docs-sidebar .nav > .active > ul {
            display: block;
        }
        .bs-docs-sidebar .nav .nav .nav > .active > a,
        .bs-docs-sidebar .nav .nav .nav > .active:hover > a,
        .bs-docs-sidebar .nav .nav .nav > .active:focus > a {
            padding-left: 38px;
            font-weight: 500;
        }
        @media print {
            pre .line-number, .print-nil {
                display: none;
            }
            pre, .text-left, .panel {
                overflow: unset;
            }
            pre, .text-left {
                white-space: pre-wrap;
            }
        }
        @media (max-width: 992px), print {
            .col-md-9 {
                width: 100%;
            }
            .col-md-3 {
                display: none;
            }
        }
        @media (max-width: 992px) {
            .modal-dialog {
                width: 95%;
            }
        }
        @media (min-width: 993px) and (max-width: 1200px) {
            .bs-docs-sidebar {
                padding-left: 10px;
                width: calc(25% - 10px - 3px);
            }
        }
        @media (min-width: 1201px) {
            .bs-docs-sidebar {
                padding-left: 20px;
                width: calc(25% - 20px - 3px);
            }
        }
    </style>
</head>
<body>
<main class="container-fluid">
    <div class="row">
        <div class="col-md-9">
            <script id="url-render" type="text/x-dot-template">
                {{~ it.moduleList  :module:index}}
                <div class="module">
                    <h2 id="{{= module.name}}" class="module-name"><span>{{= index + 1}}</span> {{= module.info || ''}}</h2>
                    {{~ module.urlList  :url:urlIndex}}
                    <div class="module-api">
                        <h3 id="{{= module.name}}-{{= url.id}}" class="module-api-index">
                            <span>{{= index + 1}}.{{= urlIndex + 1}}</span> {{= url.title || ''}}
                        </h3>
                        <div class="module-api-info">
                            <p class="module-api-info-basic">request <code>{{= url.method || ''}} {{= url.url || ''}}</code></p>
                            {{
                            var moduleDesc = '';
                            if (url.develop && url.develop !== '') {
                                moduleDesc += 'develop: ' + url.develop;
                            }
                            if (url.desc && url.desc !== '') {
                                if (moduleDesc !== '') { moduleDesc += '<br>'; }
                                moduleDesc += 'comment: ' + url.desc;
                            }

                            var printNil = '';
                            if (url.exampleUrl && url.exampleUrl != '') {
                                var example = '<a target="_blank" href="' + url.exampleUrl + '">Result example url</a>';
                                if (moduleDesc !== '') {
                                    moduleDesc += '<span class="print-nil"><br><br>' + example + '</span>';
                                } else {
                                    printNil = ' print-nil';
                                    moduleDesc += example;
                                }
                            }
                            }}
                            <pre class="module-api-info-desc{{= printNil}}">{{= moduleDesc}}</pre>

                            <div class="module-api-info-return">
                                <p>return example & comment</p>
                                <pre class="src src-json">{{= url.commentJson || ''}}</pre>

                                {{? url.returnList && url.returnList.length > 0}}
                                <div class="bottom-table panel panel-default">
                                    <table class="table table-striped table-bordered table-hover table-condensed">
                                        <thead>
                                        <tr>
                                            <th class="text-left">return field name</th>
                                            <th class="text-left">type</th>
                                            <th class="text-left">comment</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {{~ url.returnList  :rtn}}
                                        <tr>
                                            <td class="text-left">{{= rtn.name || ''}}</td>
                                            <td class="text-left">{{= rtn.type || ''}}</td>
                                            <td class="text-left wrap">{{= (rtn.desc || '').replace(/(!!!RECURSIVE OBJECT!!!)/, '<span class="bold red">$1</span>')}}</td>
                                        </tr>
                                        {{~}}
                                        </tbody>
                                    </table>
                                </div>
                                {{?}}

                                {{
                                var hasSelfResponse = false;
                                var responseList;
                                if (url.responseList && url.responseList.length > 0) {
                                    hasSelfResponse = true;
                                    responseList = url.responseList;
                                } else if (it.responseList && it.responseList.length > 0) {
                                    responseList = it.responseList;
                                } else { responseList = []; }

                                var hasAction = false;
                                for (var i = 0; i < responseList.length; i++) {
                                    var comment = responseList[i].comment;
                                    if (comment !== undefined && comment !== null && comment !== '') { hasAction = true; }
                                }
                                }}
                                {{? responseList.length > 0}}
                                <div class="bottom-table panel panel-default">
                                    <table class="table table-striped table-bordered table-hover table-condensed">
                                        <thead>
                                        <tr>
                                            <th class="text-left">Response Code</th>
                                            <th class="text-left">Comment</th>
                                            {{? hasAction}}<th class="text-left print-nil">Action</th>{{?}}
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {{~ responseList  :response}}
                                        <tr>
                                            <td class="text-left">{{= response.code || ''}}</td>
                                            <td class="text-left">{{= response.msg || ''}}</td>
                                            {{
                                            var comment = response.comment;
                                            var targetId = hasSelfResponse ? (module.name + '-' + url.id + '-' + response.code) : ('global-' + response.code);
                                            }}
                                            {{? comment !== undefined && comment !== null && comment !== ''}}
                                            <td class="text-left print-nil">
                                                <span class="response-example" title="Example when clicking to view response {{= response.code + ': ' + response.msg}}"
                                                      data-toggle="modal" data-target="#{{= targetId}}">View example</span>
                                            </td>
                                            {{?? hasAction}}
                                            <td class="text-left print-nil"></td>
                                            {{?}}
                                        </tr>
                                        {{~}}
                                        </tbody>
                                    </table>
                                </div>

                                {{? hasSelfResponse}}
                                {{~ responseList  :response}}
                                {{ var comment = response.comment; }}
                                {{? comment !== undefined && comment !== null && comment !== ''}}
                                <div id="{{= module.name}}-{{= url.id}}-{{= response.code}}" class="modal fade"
                                     tabindex="-1" aria-hidden="true" data-backdrop="static" data-keyboard="false">
                                    <div class="modal-dialog modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal">
                                                &times;
                                            </button>
                                            <h4 class="modal-title">
                                                module「{{= module.info || ''}}」api「{{= url.title || ''}}」response「{{= response.code + ': ' + response.msg}}」
                                            </h4>
                                        </div>
                                        <div class="modal-body">
                                            <pre class="src src-json">{{= response.comment || ''}}</pre>

                                            {{? response.returnList && response.returnList.length > 0}}
                                            <div class="bottom-table panel panel-default">
                                                <table class="table table-striped table-bordered table-hover table-condensed">
                                                    <thead>
                                                    <tr>
                                                        <th class="text-left">field name</th>
                                                        <th class="text-left">type</th>
                                                        <th class="text-left">comment</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {{~ response.returnList  :rtn}}
                                                    <tr>
                                                        <td class="text-left">{{= rtn.name || ''}}</td>
                                                        <td class="text-left">{{= rtn.type || ''}}</td>
                                                        <td class="text-left wrap">{{= (rtn.desc || '').replace(/(!!!RECURSIVE OBJECT!!!)/, '<span class="bold red">$1</span>')}}</td>
                                                    </tr>
                                                    {{~}}
                                                    </tbody>
                                                </table>
                                            </div>
                                            {{?}}
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                </div>
                                {{?}}
                                {{~}}
                                {{?}}
                                {{?}}
                            </div>

                            {{
                            var globalParamList = it.tokenList || [];
                            var urlParamList = url.paramList || [];
                            var paramList = (url.useGlobalParam === '1') ? globalParamList.concat(urlParamList) : urlParamList;

                            var hasDesc = false, hasFile = false, hasHeader = false;
                            for (var i = 0; i < paramList.length; i++) {
                                var paramDesc = paramList[i].desc;
                                if (paramDesc !== undefined && paramDesc !== null && paramDesc !== '') { hasDesc = true; }

                                if (paramList[i].hasFile === '1') { hasFile = true; }
                                if (paramList[i].paramType === '1') { hasHeader = true; }
                            }
                            var textNum = 0;
                            }}
                            <form class="module-api-info-param"{{? url.method}} method="{{= url.method}}"{{?}}{{? url.url}}
                                  action="{{= url.url}}"{{?}}{{? hasFile}} enctype="multipart/form-data"{{?}}>
                                {{? paramList && paramList.length > 0}}
                                <div class="bottom-table panel panel-default">
                                    <table class="table table-striped table-bordered table-hover table-condensed">
                                        <thead>
                                        <tr>
                                            <th class="text-left">param name</th>
                                            <th class="text-left example">example</th>
                                            <th class="text-left">required</th>
                                            <th class="text-left">data type</th>
                                            {{? hasHeader}}<th class="text-left">param type</th>{{?}}
                                            {{? hasDesc}}<th class="text-left">comment</th>{{?}}
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {{~ paramList  :param:paramIndex}}
                                        <tr{{? param.hasMust === '1'}} class="bold"{{?}}{{? param.style && param.style !== ''}} style="{{= param.style}}"{{?}}>
                                            <td class="text-left">{{= param.name || ''}}</td>
                                            <td class="text-left" style="height: inherit;">
                                                {{
                                                var arr = [];
                                                if (param.hasMust === '1') { arr.push('required'); }

                                                if (param.dataType === 'int' || param.dataType === 'long') { arr.push('custom[integer]'); }
                                                else if (param.dataType === 'float' || param.dataType === 'double') { arr.push('custom[number]'); }
                                                else if (param.dataType === 'email') { arr.push('custom[email]'); }
                                                else if (param.dataType === 'url') { arr.push('custom[url]'); }
                                                else if (param.dataType === 'ipv4') { arr.push('custom[ipv4]'); }

                                                var arrJoin = arr.filter(function(e){ return e !== undefined && e !== null && e !== ''; }).join(',');

                                                var validateClass = (arrJoin !== undefined && arrJoin !== null && arrJoin !== '') ? (' validate[' + arrJoin + ']') : '';
                                                var tokenClass = (param.hasToken === '1') ? ' has-token' : '';
                                                var header = (param.paramType === '1') ? ' header="true"' : '';
                                                var example = localStorage.getItem(param.name) || param.example || '';

                                                var enumRegexExec = /^enum\((.*?)\)$/.exec(param.dataType);
                                                var enumInfo = (Array.isArray(enumRegexExec) && enumRegexExec.length > 1) ? it.enumInfo[enumRegexExec[1]] : '';
                                                }}
                                                {{? param.dataType === 'file'}}
                                                <div class="input-group">
                                                    <label class="input-group-btn">
                                                            <span class="btn btn-default{{? param.hasMust === '1'}} bold{{?}}">
                                                                Browse...
                                                                <input type="file" name="{{= param.name || ''}}" style="display: none;">
                                                            </span>
                                                    </label>
                                                    <input type="text" class="form-control{{? param.hasMust === '1'}} bold{{?}}{{= validateClass}}" readonly="readonly">
                                                </div>
                                                {{?? param.hasTextarea === '1'}}
                                                <textarea class="form-control{{= validateClass}}{{= tokenClass}}" name="{{= param.name || ''}}"{{= header}}>{{= example}}</textarea>
                                                {{?? enumInfo !== undefined && enumInfo !== null && enumInfo !== ''}}
                                                <select class="form-control{{= validateClass}}{{= tokenClass}}" name="{{= param.name || ''}}"{{= header}}>
                                                    <option></option>
                                                    {{? Array.isArray(enumInfo) }}
                                                    {{~ enumInfo  :e}}<option{{? example === e}} selected="selected"{{?}}>{{= e}}</option>{{~}}
                                                    {{??}}
                                                    {{ var k; for(k in enumInfo) { }}
                                                    <option value="{{= k}}"{{? example === k || example === enumInfo[k]}} selected="selected"{{?}}>{{= enumInfo[k]}}</option>
                                                    {{ } }}
                                                    {{?}}
                                                </select>
                                                {{?? param.showDataType === 'date' || param.dataType === 'date'}}
                                                <div class="input-group date form-datetime">
                                                    <span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
                                                    <input type="text" class="form-control{{? param.hasMust === '1'}} bold{{?}}{{= validateClass}}{{= tokenClass}}"
                                                           data-date-format="{{= param.datePattern || ''}}" readonly="readonly"
                                                           name="{{= param.name || ''}}"{{= header}}/>
                                                </div>
                                                {{??}}
                                                {{ textNum++; }}
                                                <input class="form-control{{= validateClass}}{{= tokenClass}}"
                                                       type="{{= (param.name || '').toLowerCase() === 'password' ? 'password' : 'text'}}"
                                                       name="{{= param.name || ''}}"{{= header}} value="{{= example}}"/>
                                                {{?}}
                                            </td>
                                            <td class="text-left">{{= param.hasMust === '1' ? 'Yes' : 'No'}}</td>
                                            <td class="text-left">{{=
                                                param.showDataType !== undefined && param.showDataType !== null && param.showDataType !== ''
                                                ? param.showDataType
                                                : (param.dataType !== undefined && param.dataType !== null && param.dataType !== '' ? param.dataType : '')
                                            }}</td>
                                            {{? hasHeader}}<td class="text-left">{{= (param.paramType || '') === '1' ? 'Header' : 'Query'}}</td>{{?}}
                                            {{? hasDesc}}<td class="text-left wrap">{{= param.desc || ''}}</td>{{?}}
                                        </tr>
                                        {{~}}
                                        </tbody>
                                    </table>
                                </div>
                                {{?}}
                                <p>
                                    /* When there is only one input text on the form, adding an invisible input can disable the carriage return event for that input. */
                                    {{? textNum === 1 }}<input type="text" style="display: none;"/>{{?}}
                                    <input class="btn" type="button" value="Request backend" requestBody="{{= url.requestBody}}"/>
                                </p>
                                <div class="curl"><pre class="src src-json"></pre></div>
                                <div class="response"><pre class="src src-json"></pre></div>
                            </form>
                        </div>
                    </div>
                    {{~}}
                </div>
                {{~}}

                {{~ it.responseList  :response}}
                {{ var comment = response.comment; }}
                {{? comment !== undefined && comment !== null && comment !== ''}}
                <div id="global-{{= response.code}}" class="modal fade" tabindex="-1"
                     aria-hidden="true" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">
                                &times;
                            </button>
                            <h4 class="modal-title">
                                View example of global response「{{= response.code + ': ' + response.msg}}」
                            </h4>
                        </div>
                        <div class="modal-body">
                            <pre class="src src-json">{{= response.comment || ''}}</pre>

                            {{? response.returnList && response.returnList.length > 0}}
                            <div class="bottom-table panel panel-default">
                                <table class="table table-striped table-bordered table-hover table-condensed">
                                    <thead>
                                    <tr>
                                        <th class="text-left">field name</th>
                                        <th class="text-left">type</th>
                                        <th class="text-left">comment</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {{~ response.returnList  :rtn}}
                                    <tr>
                                        <td class="text-left">{{= rtn.name || ''}}</td>
                                        <td class="text-left">{{= rtn.type || ''}}</td>
                                        <td class="text-left wrap">{{= (rtn.desc || '').replace(/(!!!RECURSIVE OBJECT!!!)/, '<span class="bold red">$1</span>')}}</td>
                                    </tr>
                                    {{~}}
                                    </tbody>
                                </table>
                            </div>
                            {{?}}
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
                {{?}}
                {{~}}
            </script>
        </div>
        <div class="col-md-3">
            <div class="bs-docs-sidebar">
                <ul class="nav">
                    <script id="url-nav-render" type="text/x-dot-template">
                        {{~ it.moduleList  :module:index}}
                        <li>
                            <a href="#{{= module.name}}">{{= index + 1}} {{= module.info || ''}}</a>
                            <ul class="nav">
                                {{~ module.urlList  :url:urlIndex}}
                                <li>
                                    <a href="#{{= module.name}}-{{= url.id}}">{{= index + 1}}.{{= urlIndex + 1}} {{= url.title || ''}}</a>
                                </li>
                                {{~}}
                            </ul>
                        </li>
                        {{~}}
                    </script>
                </ul>
            </div>
        </div>
    </div>
</main>
<footer>
    <script id="copyright" type="text/x-dot-template">
        <div>
            <p class="version">Version: {{= it.version || ''}}</p>
            <p class="statistics">{{= it.groupCount || ''}} module, {{= it.apiCount || ''}} api</p>
            <p class="team">{{= it.team || ''}}</p>
            <p class="copyright">&copy; {{= new Date().getFullYear()}} {{= it.copyright || ''}}</p>
        </div>
    </script>
</footer>

<!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<script type="text/javascript">
var projectDomain = '';
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript">
/* basic: page scroll */
$(function() {
    'use strict';
    $(document.body).scrollspy({target: '.bs-docs-sidebar'});

    var topBottomHeight = 30;
    var heightProperty = 'max-height';

    var html = document.getElementsByTagName('html')[0];
    var footer = document.getElementsByTagName('footer')[0];

    var $win = $(window);
    var $nav = $('.col-md-3');
    var $bar = $('.bs-docs-sidebar > .nav');

    var firstHash = window.location.hash;
    var firstScroll = firstHash === undefined || firstHash === null || firstHash === '';
    if (!firstScroll) {
        window.history.replaceState({page: 'index'}, '', window.location.pathname);
        window.history.pushState({api: firstHash}, '', firstHash);
    }
    $win.scroll(function() {
        if ($nav.css('display') !== 'none') {
            {
                var footerTop = footer.offsetTop;
                var scrollTop = $win.scrollTop();
                var pageHeight = scrollTop + $win.height();
                if (footerTop >= scrollTop && footerTop < (pageHeight)) {
                    var footViewHeight = pageHeight - footerTop;
                    $bar.css(heightProperty, 'calc(100vh - ' + (topBottomHeight + footViewHeight) + 'px)');
                } else {
                    var htmlViewHeight = (html.clientHeight - topBottomHeight) + 'px';
                    if ($bar.css(heightProperty) !== htmlViewHeight) {
                        $bar.css(heightProperty, 'calc(100vh - ' + topBottomHeight + 'px)');
                    }
                }
            }


            {
                if (firstScroll) {
                    firstScroll = false;
                    window.history.pushState({api: ''}, '', '');
                }
                var hash = $nav.find('.active > a:last').attr('href');
                if (hash !== window.location.hash) {
                    if (hash === undefined || hash === null || hash === '') {
                        window.history.replaceState({api: 'index'}, '', window.location.pathname);
                    } else {
                        window.history.replaceState({api: hash}, '', hash);
                    }
                }
            }
        }
    });
});
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/dot/1.1.2/doT.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
<script type="text/javascript">
/* data: page info */
function isBlank(str) {
    return str === undefined || str === null || str === 'undefined' || str === 'null' || str === '';
}
function isNotBlank(str) {
    return !isBlank(str);
}
function addLine(html) {
    if (isBlank(html)) {
        return '';
    }

    var lineNum = html.split(/\n/).length;
    var lineHtml = '<span class="line-number">';
    var i;
    for (i = 0; i < lineNum; i++) {
        lineHtml += (i + 1) + '\n';
    }
    lineHtml = lineHtml.trim();
    lineHtml += '</span>';
    return lineHtml + html;
}

var locationDomain = window.location.protocol + '//' + window.location.host;
if (isNotBlank(projectDomain) && locationDomain !== projectDomain && !projectDomain.startsWith(locationDomain + '/')) {
    $.ajaxSetup({
        crossDomain: true,
        xhrFields: { withCredentials: true }
    });
}

var $main = $('.col-md-9');
$.get(projectDomain + '/api/info').done(function(data) {
    if (isNotBlank(data)) {
        var documentInfo;
        if (typeof data === 'string') {
            documentInfo = JSON.parse(data);
        } else {
            documentInfo = data;
        }


        {
            var copyright = documentInfo.copyright;
            if (isBlank(copyright)) {
                return;
            }
            if (isNotBlank(copyright.title)) {
                $('title').html(copyright.title);
            }
            var $copyrightRender = $('#copyright');
            var template = doT.template($copyrightRender.html());
            $copyrightRender.parent().html(template(copyright));
        }


        {
            var doc = documentInfo.document;
            if (isBlank(doc)) {
                return;
            }
            var $urlRender = $('#url-render');
            var urlRenderTemplate = doT.template($urlRender.html());
            $urlRender.parent().html(urlRenderTemplate(doc));

            var $navRender = $('#url-nav-render');
            var navRenderTemplate = doT.template($navRender.html());
            $navRender.parent().html(navRenderTemplate(doc));

            $('pre[class="src src-json"]').each(function() {
                var $html = escapeHtml($(this).html());
                var html;
                if (isNotBlank($html)) {
                    html = $html.replace(/(.*?)(\/\*.*?\*\/)/g, '$1<span class="comment">$2</span>');

                    var recursiveRegex = /(!!!RECURSIVE OBJECT!!!)/;
                    if (recursiveRegex.test($html)) {
                        html = html.replace(new RegExp(recursiveRegex, 'g'), '<span class="bold red">$1</span>');
                    }
                } else {
                    html = '<span class="red">Return null or Can not analyze return type</span>';
                }
                $(this).html(addLine(html));
            });

            var hash = window.location.hash;
            if (isNotBlank(hash)) {
                var $anchor = $(hash);
                if ($anchor.length > 0) {
                    var $current = $('a[href="' + hash + '"]').parents('li');
                    $current.addClass('active');

                    var $module = $current.parents('li');
                    $module.addClass('active');
                    $('html,body').animate({scrollTop: $anchor.offset().top}, 0);
                }
            }

            $('.form-datetime').datetimepicker({
                ignoreReadonly: true,
                showTodayButton: true,
                showClear: true,
                showClose: true
            });
        }
    } else {
        $main.html('<span class="red">no api info</span>');
    }
}).fail(function() {
    $main.html('<span class="red">request error</span>');
});

function escapeHtml(html) {
    return isBlank(html) ? null : html.replace(/</g, '&lt;').replace(/>/g, '&gt;');
}
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jQuery-Validation-Engine/2.6.4/languages/jquery.validationEngine-en.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jQuery-Validation-Engine/2.6.4/jquery.validationEngine.min.js"></script>
<script type="text/javascript">
/* action: request backend */
if (isBlank(projectDomain)) {
    projectDomain = window.location.protocol + '//' + window.location.host;
}
if (projectDomain.endsWith('/')) {
    projectDomain = projectDomain.substring(0, projectDomain.length - 1);
}

function timeLog(start) {
    var end = new Date().getTime();
    return 'use time: ' + (end - start) + 'ms\n' + formatDate(start) + ' -> ' + formatDate(end) + '\n\n';
}
function objectifyForm(form) {
    var headers = {};
    var params = {};
    $.each(form.serializeArray(), function(i, field) {
        var name = field.name;
        var value = field.value;

        var header = form.find('[name="' + name + '"]').attr('header');
        if (header && (header === 'true' || header === true)) {
            headers[name] = value;
        } else {
            params[name] = value;
        }
    });
    return [params, headers, form.find('input[type="file"]')];
}
function formatDate(date) {
    var d = new Date(date);

    var y = d.getFullYear().toString();
    var m = (d.getMonth() + 1).toString();
    if (m.length === 1) {
        m = '0' + m;
    }
    var dy = d.getDate().toString();
    if (dy.length === 1) {
        dy = '0' + dy;
    }
    var h = d.getHours().toString();
    if (h.length === 1) {
        h = '0' + h;
    }
    var mt = d.getMinutes().toString();
    if (mt.length === 1) {
        mt = '0' + mt;
    }
    var s = d.getSeconds().toString();
    if (s.length === 1) {
        s = '0' + s;
    }
    var S = d.getMilliseconds().toString();
    if (S.length === 1) {
        S = '00' + S;
    } else if (S.length === 2) {
        S = '0' + S;
    }
    return y + '-' + m + '-' + dy + ' ' + h + ':' + mt + ':' + s + ' ' + S;
}

$.validationEngine.defaults.scroll = false;

$(function() {
    $(document).on('change', ':file', function() {
        var $this = $(this);
        $this.parents('.input-group').find(':text').val($this.val());
    });
    $(document).on('change', '.has-token', function() {
        var $this = $(this);
        var name = $this.attr('name');
        var value = $this.val();
        localStorage.setItem(name, value);
        $('[name="' + name + '"]').val(value);
    });

    $(document).on('click', 'input[type="button"]', function() {
        var $btn = $(this);
        var $form = $btn.parents('form');
        var curl = $form.find('.curl');
        var response = $form.find('.response');
        curl.hide();
        response.hide();

        var flag = $form.validationEngine('validate', { scroll: false });
        if (!flag) {
            return;
        }

        var method = $form.attr('method');
        var url = $form.attr('action');
        var requestBody = $btn.attr('requestBody');
        var hasRequestBody = requestBody === true || requestBody === 'true';

        var map = objectifyForm($form);
        var params = map[0];
        var headers = map[1];
        var files = map[2];

        if (!url.toLowerCase().startsWith('http://') && !url.toLowerCase().startsWith('https://')) {
            if (!url.startsWith('/')) {
                url = '/' + url;
            }
            url = projectDomain + url;
        }

        var placeRegex = /{(.*?)}/;
        while (placeRegex.test(url)) {
            var group = RegExp.$1;
            var value = params[group];
            // url </user/{id}> change to </user/123>, params <name=xyz&id=&gender=1> change to <name=xyz&gender=1>
            url = url.replace(placeRegex, value);
            delete params[group];
        }


        {
            var tmpUrl = url;
            var line = ' \\\n';
            var curlHtml = 'curl -i -X ' + method + line;
            curlHtml += "&nbsp; -A '" + navigator.userAgent + "'" + line;
            if (isNotBlank(document.cookie)) {
                curlHtml += "&nbsp; -b '" + document.cookie + "'" + line;
            }
            if (Object.getOwnPropertyNames(headers).length > 0) {
                $.each(headers, function(key, value) {
                    if (isNotBlank(key) && isNotBlank(value)) {
                        curlHtml += "&nbsp; -H '" + (key + ': ' + value) + "'" + line;
                    }
                });
            }
            if (hasRequestBody) {
                curlHtml += "&nbsp; -H 'Content-Type: application/json'" + line;
                curlHtml += "&nbsp; -H 'Accept: application/json'" + line;
            }
            if (files.length > 0) {
                if (Object.getOwnPropertyNames(params).length > 0) {
                    $.each(params, function(key, value) {
                        if (isNotBlank(key) && isNotBlank(value)) {
                            curlHtml += "&nbsp; -F '" + (key + '=' + value) + "'" + line;
                        }
                    });
                }
                $.each(files, function(i, file) {
                    var fileName = file.name;
                    var filePath = file.value;
                    if (isNotBlank(fileName) && isNotBlank(filePath)) {
                        filePath = filePath.replace('C:\\fakepath\\', '/$REPLACE_REAL_PATH$/');
                        curlHtml += "&nbsp; -F '" + (fileName + '=@' + filePath) + "'" + line;
                    }
                });
            } else {
                if (Object.getOwnPropertyNames(params).length > 0) {
                    if (hasRequestBody) {
                        curlHtml += "&nbsp; -d '" + JSON.stringify(params) + "'" + line;
                    } else {
                        if ('GET' === method.toUpperCase()) {
                            var paramArr = [];
                            $.each(params, function(key, value) {
                                if (isNotBlank(key) && isNotBlank(value)) {
                                    paramArr.push(key + '=' + value);
                                }
                            });
                            var paramStr = paramArr.join('&');
                            if (paramStr.length > 0) {
                                tmpUrl += (url.includes('?') ? '&' : '?') + paramStr;
                            }
                        } else {
                            $.each(params, function(key, value) {
                                if (isNotBlank(key) && isNotBlank(value)) {
                                    curlHtml += "&nbsp; -d '" + (key + '=' + value) + "'" + line;
                                }
                            });
                        }
                    }
                }
            }
            curlHtml += "&nbsp; --url '" + tmpUrl + "'";
            curlHtml = curlHtml.replace(/&nbsp;/g, ' ');
            if (curlHtml.length <= 100) {
                curlHtml = curlHtml.replace(new RegExp(line.replace('\\', '\\\\'), 'g'), '');
                if (!curlHtml.includes('\\')) {
                    curlHtml = curlHtml.replace(/\s{2,}/g, ' ');
                }
            }
            curl.find('pre').html(curlHtml);
            curl.show();
        }


        {
            var settings = {
                url: url,
                method: method,
                beforeSend: function(request) {
                    if (Object.getOwnPropertyNames(headers).length > 0) {
                        $.each(headers, function(key, value) {
                            if (isNotBlank(key) && isNotBlank(value)) {
                                request.setRequestHeader(key, value);
                            }
                        });
                    }
                }
            };
            if (files.length > 0) {
                if ('POST' !== method.toUpperCase()) {
                    response.find('pre').html("<span class='red'>Upload files must use POST(It's possible to use the above cURL), please contact the backend to change!</span>");
                    response.show();
                    return;
                }

                var formData = new FormData();
                $.each(params, function(key, value) {
                    if (isNotBlank(key) && isNotBlank(value)) {
                        formData.append(key, value);
                    }
                });
                $.each(files, function(i, f) {
                    formData.append(f.name, f.files[0]);
                });

                settings['data'] = formData;
                settings['cache'] = false;
                settings['processData'] = false;
                settings['contentType'] = false;
            } else {
                if (hasRequestBody) {
                    if ('GET' === method.toUpperCase()) { // https://stackoverflow.com/questions/978061/http-get-with-request-body
                        response.find('pre').html("<span class='red'>Browser cannot send RequestBody parameter via a GET request" +
                            "(It's possible to use the above cURL), please contact the backend change to POST!</span>");
                        response.show();
                        return;
                    }
                    settings['contentType'] = 'application/json';
                    settings['dataType'] = 'json';
                    settings['data'] = JSON.stringify(params);
                } else {
                    settings['data'] = params;
                }
            }

            var responseData = response.find('pre');
            var start = new Date().getTime();
            $btn.attr('disabled', 'disabled');
            $btn.addClass('disabled');
            $.ajax(settings).done(function(result) {
                var html = timeLog(start);
                if (isBlank(result)) {
                    html += '<span class="green">' + method + ' (' + url + ') success, but response nil</span>';
                } else {
                    html += addLine(escapeHtml(JSON.stringify(result, null, 2)));
                }
                responseData.html(html);
                response.show();
                $btn.removeAttr('disabled');
                $btn.removeClass('disabled');
            }).fail(function(error) {
                var html = timeLog(start);
                if (isBlank(error)) {
                    html += '<span class="red">' + method + ' (' + url + ') fail</span>';
                } else {
                    html += '<span class="red">Response Code: ' + error.status + '</span>';
                    var json = error.responseJSON;
                    if (isNotBlank(json)) {
                        html += '\n\n' + addLine(escapeHtml(JSON.stringify(json, null, 2)));
                    } else {
                        var text = error.responseText;
                        if (isNotBlank(text)) {
                            html += '\n<span class="red wrap">Response Text: ' + escapeHtml(text) + '</span>';
                        } else {
                            html += '\n<span class="red">The response is empty</span>';
                        }
                    }
                }
                responseData.html(html);
                response.show();
                $btn.removeAttr('disabled');
                $btn.removeClass('disabled');
            });
        }
    });
});
</script>
</body>
</html>
