<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>接口文档</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgo=">
    <link rel="stylesheet" href="//cdn.bootcss.com/twitter-bootstrap/3.4.1/css/bootstrap.min.css">
    <style type="text/css">
        html {
            position: relative;
            min-height: 100%;
        }
        body {
            font-size: 16px;
        }
        footer {
            position: absolute;
            height: 133px;
            width: 100%;
            background: #f5f5f5;
        }
        footer > div {
            padding: 10px;
        }
        footer p {
            margin: 5px 0;
            text-align: center;
        }
        pre {
            font-size: 14px;
            overflow: auto;
            margin: 0 0 14px;
            padding: 7px 14px;
        }
        pre .line-number {
            color: #2B91AF;
            display: block;
            float: left;
            margin: 0 14px 0 -14px;
            border-right: 1px solid;
            text-align: right;
            padding: 0 7px 0 14px;
        }
        pre .comment {
            color: #998;
            font-style: italic;
        }

        .module {}
        .module-name {
            border-bottom: 5px solid #eee;
            margin-bottom: -5px;
        }
        .module-api {
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
        }
        .module-api-index {}
        .module-api-info {}
        .module-api-info-basic {}
        .module-api-info-desc {}
        .module-api-info-param {}
        .module-api-info-return {}
        .bottom-table {
            margin-bottom: 10px;
        }
        .text-left {
            vertical-align: middle !important;
        }
        .response-example {
            color: #337ab7;
            text-decoration: none;
            background-color: transparent;
            cursor: pointer;
        }
        .response-example:focus, .response-example:hover {
            color: #23527c;
            text-decoration: underline;
        }
        .modal-dialog {
            width: 75%;
        }
        .bold {
            font-weight: bold;
        }
        .wrap {
            white-space: pre-wrap;
        }
        .red {
            color: red;
        }

        .bs-docs-sidebar {
            width: inherit;
            position: fixed;
            margin: 15px 0;
        }
        .bs-docs-sidebar > .nav {
            overflow-y: auto;
            max-height: calc(100vh - 30px); /* 100vh - top - bottom */
        }
        .bs-docs-sidebar .nav > li > a {
            display: block;
            padding: 4px 0 4px 20px;
            font-size: 14px;
            font-weight: 500;
            color: #999;
        }
        .bs-docs-sidebar .nav > li > a:hover,
        .bs-docs-sidebar .nav > li > a:focus {
            padding-left: 19px;
            color: #A1283B;
            text-decoration: none;
            background-color: transparent;
            border-left: 1px solid #A1283B;
        }
        .bs-docs-sidebar .nav > .active > a,
        .bs-docs-sidebar .nav > .active:hover > a,
        .bs-docs-sidebar .nav > .active:focus > a {
            padding-left: 18px;
            font-weight: bold;
            color: #A1283B;
            background-color: transparent;
            border-left: 2px solid #A1283B;
        }
        .bs-docs-sidebar .nav .nav {
            display: none;
            padding-bottom: 10px;
        }
        .bs-docs-sidebar .nav .nav > li > a {
            padding-top: 1px;
            padding-bottom: 1px;
            padding-left: 30px;
            font-size: 12px;
            font-weight: normal;
        }
        .bs-docs-sidebar .nav .nav > li > a:hover,
        .bs-docs-sidebar .nav .nav > li > a:focus {
            padding-left: 29px;
        }
        .bs-docs-sidebar .nav .nav > .active > a,
        .bs-docs-sidebar .nav .nav > .active:hover > a,
        .bs-docs-sidebar .nav .nav > .active:focus > a {
            padding-left: 28px;
            font-weight: 500;
        }
        .bs-docs-sidebar .nav .nav .nav {
            padding-bottom: 10px;
        }
        .bs-docs-sidebar .nav .nav .nav > li > a {
            padding-top: 1px;
            padding-bottom: 1px;
            padding-left: 40px;
            font-size: 12px;
            font-weight: normal;
        }
        .bs-docs-sidebar .nav .nav .nav > li > a:hover,
        .bs-docs-sidebar .nav .nav .nav > li > a:focus {
            padding-left: 39px;
        }
        .bs-docs-sidebar .nav > .active > ul {
            display: block;
        }
        .bs-docs-sidebar .nav .nav .nav > .active > a,
        .bs-docs-sidebar .nav .nav .nav > .active:hover > a,
        .bs-docs-sidebar .nav .nav .nav > .active:focus > a {
            padding-left: 38px;
            font-weight: 500;
        }
        @media print {
            .print-nil {
                display: none;
            }
        }
        @media (max-width: 992px), print {
            .col-md-9 {
                width: 100%;
            }
            .col-md-3 {
                display: none;
            }
        }
        @media (min-width: 993px) and (max-width: 1200px) {
            .bs-docs-sidebar {
                padding-left: 10px;
                width: calc(25% - 10px - 3px);
            }
        }
        @media (min-width: 1201px) {
            .bs-docs-sidebar {
                padding-left: 20px;
                width: calc(25% - 20px - 3px);
            }
        }
    </style>
</head>
<body>
<main class="container">
    <div class="row">
        <div class="col-md-9">
            <script id="url-render" type="text/x-dot-template">
                {{~ it.moduleList  :module:index}}
                <div class="module">
                    <h2 id="{{= module.name}}" class="module-name"><span>{{= index + 1}}</span> {{= module.info || ''}}</h2>
                    {{~ module.urlList  :url:urlIndex}}
                    <div class="module-api">
                        <h3 id="{{= module.name}}-{{= url.id}}" class="module-api-index">
                            <span>{{= index + 1}}.{{= urlIndex + 1}}</span> {{= url.title || ''}}
                        </h3>
                        <div class="module-api-info">
                            <p class="module-api-info-basic">接口地址 <code>{{= url.method || ''}} {{= url.url || ''}}</code></p>
                            {{
                            var moduleDesc = '';
                            if (url.develop && url.develop !== '') {
                                moduleDesc += '开发: ' + url.develop;
                            }
                            if (url.desc && url.desc !== '') {
                                if (moduleDesc !== '') { moduleDesc += '<br>'; }
                                moduleDesc += '说明: ' + url.desc;
                            }

                            var printNil = '';
                            if (url.exampleUrl && url.exampleUrl != '') {
                                var example = '<a target="_blank" href="' + url.exampleUrl + '">响应结果示例地址</a>';
                                if (moduleDesc !== '') {
                                    moduleDesc += '<span class="print-nil"><br><br>' + example + '</span>';
                                } else {
                                    printNil = ' print-nil';
                                    moduleDesc += example;
                                }
                            }
                            }}
                            <pre class="module-api-info-desc{{= printNil}}">{{= moduleDesc}}</pre>

                            {{
                            var globalParamList = it.tokenList || [];
                            var urlParamList = url.paramList || [];
                            var paramList = (url.useGlobalParam === true) ? globalParamList.concat(urlParamList) : urlParamList;

                            var hasExample = false, hasHeader = false;
                            for (var i = 0; i < paramList.length; i++) {
                                var urlExample = paramList[i].example;
                                if (urlExample !== undefined && urlExample !== null && urlExample !== '') { hasExample = true; }
                                if (paramList[i].paramType === 'Header') { hasHeader = true; }
                            }
                            }}
                            {{? paramList && paramList.length > 0}}
                            <div class="module-api-info-param bottom-table panel panel-default">
                                <table class="table table-striped table-bordered table-hover table-condensed">
                                    <thead>
                                    <tr>
                                        <th class="text-left">参数名称</th>
                                        <th class="text-left">数据类型</th>
                                        <th class="text-left">必须</th>
                                        <th class="text-left">说明</th>
                                        {{? hasExample}}<th class="text-left">示例</th>{{?}}
                                        {{? hasHeader}}<th class="text-left">参数类型</th>{{?}}
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {{~ paramList  :param}}
                                    <tr{{? param.must}} class="bold"{{?}}{{? param.style && param.style !== ''}} style="{{= param.style}}"{{?}}>
                                        <td class="text-left">{{= param.name || ''}}</td>
                                        <td class="text-left">{{= param.dataType || ''}}</td>
                                        <td class="text-left">{{= param.must ? 'Yes' : 'No'}}</td>
                                        <td class="text-left wrap">{{= param.desc || ''}}</td>
                                        {{? hasExample}}<td class="text-left wrap">{{= param.example || ''}}</td>{{?}}
                                        {{? hasHeader}}<td class="text-left">{{= param.paramType || ''}}</td>{{?}}
                                    </tr>
                                    {{~}}
                                    </tbody>
                                </table>
                            </div>
                            {{?}}

                            <div class="module-api-info-return">
                                <p>响应示例及说明如下</p>
                                <pre class="src src-json">{{= url.commentJson || ''}}</pre>

                                {{? url.returnList && url.returnList.length > 0}}
                                <div class="bottom-table panel panel-default">
                                    <table class="table table-striped table-bordered table-hover table-condensed">
                                        <thead>
                                        <tr>
                                            <th class="text-left">名称</th>
                                            <th class="text-left">类型</th>
                                            <th class="text-left">说明</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {{~ url.returnList  :rtn}}
                                        <tr>
                                            <td class="text-left">{{= rtn.name || ''}}</td>
                                            <td class="text-left">{{= rtn.type || ''}}</td>
                                            <td class="text-left wrap">{{= rtn.desc || ''}}</td>
                                        </tr>
                                        {{~}}
                                        </tbody>
                                    </table>
                                </div>
                                {{?}}

                                {{
                                var hasSelfResponse = false;
                                var responseList;
                                if (url.responseList && url.responseList.length > 0) {
                                    hasSelfResponse = true;
                                    responseList = url.responseList;
                                } else if (it.responseList && it.responseList.length > 0) {
                                    responseList = it.responseList;
                                } else { responseList = []; }

                                var hasAction = false;
                                for (var i = 0; i < responseList.length; i++) {
                                    var comment = responseList[i].comment;
                                    if (comment !== undefined && comment !== null && comment !== '') { hasAction = true; }
                                }
                                }}
                                {{? responseList.length > 0}}
                                <div class="bottom-table panel panel-default">
                                    <table class="table table-striped table-bordered table-hover table-condensed">
                                        <thead>
                                        <tr>
                                            <th class="text-left">响应码</th>
                                            <th class="text-left">说明</th>
                                            {{? hasAction}}<th class="text-left">操作</th>{{?}}
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {{~ responseList  :response}}
                                        <tr>
                                            <td class="text-left">{{= response.code || ''}}</td>
                                            <td class="text-left">{{= response.msg || ''}}</td>
                                            {{
                                            var comment = response.comment;
                                            var targetId = hasSelfResponse ? (module.name + '-' + url.id + '-' + response.code) : ('global-' + response.code);
                                            }}
                                            {{? comment !== undefined && comment !== null && comment !== ''}}
                                            <td class="text-left">
                                                <span class="response-example" title="点击查看响应 {{= response.code + ': ' + response.msg}} 时的示例"
                                                      data-toggle="modal" data-target="#{{= targetId}}">查看示例</span>
                                            </td>
                                            {{?? hasAction}}
                                            <td class="text-left"></td>
                                            {{?}}
                                        </tr>
                                        {{~}}
                                        </tbody>
                                    </table>
                                </div>

                                {{? hasSelfResponse}}
                                {{~ responseList  :response}}
                                {{ var comment = response.comment; }}
                                {{? comment !== undefined && comment !== null && comment !== ''}}
                                <div id="{{= module.name}}-{{= url.id}}-{{= response.code}}" class="modal fade" tabindex="-1"
                                     aria-hidden="true" data-backdrop="static" data-keyboard="false">
                                    <div class="modal-dialog modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal">
                                                &times;
                                            </button>
                                            <h4 class="modal-title">
                                                模块「{{= module.info || ''}}」接口「{{= url.title || ''}}」响应「{{= response.code + ': ' + response.msg}}」的示例
                                            </h4>
                                        </div>
                                        <div class="modal-body">
                                            <pre class="src src-json">{{= response.comment || ''}}</pre>

                                            {{? response.returnList && response.returnList.length > 0}}
                                            <div class="bottom-table panel panel-default">
                                                <table class="table table-striped table-bordered table-hover table-condensed">
                                                    <thead>
                                                    <tr>
                                                        <th class="text-left">名称</th>
                                                        <th class="text-left">类型</th>
                                                        <th class="text-left">说明</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {{~ response.returnList  :rtn}}
                                                    <tr>
                                                        <td class="text-left">{{= rtn.name || ''}}</td>
                                                        <td class="text-left">{{= rtn.type || ''}}</td>
                                                        <td class="text-left wrap">{{= rtn.desc || ''}}</td>
                                                    </tr>
                                                    {{~}}
                                                    </tbody>
                                                </table>
                                            </div>
                                            {{?}}
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                                        </div>
                                    </div>
                                </div>
                                {{?}}
                                {{~}}
                                {{?}}
                                {{?}}
                            </div>
                        </div>
                    </div>
                    {{~}}
                </div>
                {{~}}

                {{~ it.responseList  :response}}
                {{ var comment = response.comment; }}
                {{? comment !== undefined && comment !== null && comment !== ''}}
                <div id="global-{{= response.code}}" class="modal fade" tabindex="-1"
                     aria-hidden="true" data-backdrop="static" data-keyboard="false">
                    <div class="modal-dialog modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal">
                                &times;
                            </button>
                            <h4 class="modal-title">
                                全局响应「{{= response.code + ': ' + response.msg}}」的示例
                            </h4>
                        </div>
                        <div class="modal-body">
                            <pre class="src src-json">{{= response.comment || ''}}</pre>

                            {{? response.returnList && response.returnList.length > 0}}
                            <div class="bottom-table panel panel-default">
                                <table class="table table-striped table-bordered table-hover table-condensed">
                                    <thead>
                                    <tr>
                                        <th class="text-left">名称</th>
                                        <th class="text-left">类型</th>
                                        <th class="text-left">说明</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {{~ response.returnList  :rtn}}
                                    <tr>
                                        <td class="text-left">{{= rtn.name || ''}}</td>
                                        <td class="text-left">{{= rtn.type || ''}}</td>
                                        <td class="text-left wrap">{{= rtn.desc || ''}}</td>
                                    </tr>
                                    {{~}}
                                    </tbody>
                                </table>
                            </div>
                            {{?}}
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        </div>
                    </div>
                </div>
                {{?}}
                {{~}}
            </script>
        </div>
        <div class="col-md-3">
            <div class="bs-docs-sidebar">
                <ul class="nav">
                    <script id="url-nav-render" type="text/x-dot-template">
                        {{~ it.moduleList  :module:index}}
                        <li>
                            <a href="#{{= module.name}}">{{= index + 1}} {{= module.info || ''}}</a>
                            <ul class="nav">
                                {{~ module.urlList  :url:urlIndex}}
                                <li>
                                    <a href="#{{= module.name}}-{{= url.id}}">{{= index + 1}}.{{= urlIndex + 1}} {{= url.title || ''}}</a>
                                </li>
                                {{~}}
                            </ul>
                        </li>
                        {{~}}
                    </script>
                </ul>
            </div>
        </div>
    </div>
</main>
<footer>
    <script id="copyright" type="text/x-dot-template">
        <div>
            <p class="version">版本: <span>{{= it.version || ''}}</span></p>
            <p class="statistics">共 {{= it.groupCount || ''}} 个模块, {{= it.apiCount || ''}} 个接口</p>
            <p class="team">{{= it.team || ''}}</p>
            <p class="copyright">&copy; {{= new Date().getFullYear()}} {{= it.copyright || ''}}</p>
        </div>
    </script>
</footer>

<!--[if lt IE 9]>
<script src="//cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<script type="text/javascript">
var projectDomain = '';
</script>
<script src="//cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="//cdn.bootcss.com/twitter-bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript">
/* basic: page scroll */
$(function() {
    'use strict';
    $(document.body).scrollspy({target: '.bs-docs-sidebar'});

    var topBottomHeight = 30;
    var heightProperty = 'max-height';

    var html = document.getElementsByTagName('html')[0];
    var footer = document.getElementsByTagName('footer')[0];

    var $win = $(window);
    var $nav = $('.col-md-3');
    var $bar = $('.bs-docs-sidebar > .nav');

    var firstHash = window.location.hash;
    var firstScroll = firstHash === undefined || firstHash === null || firstHash === '';
    if (!firstScroll) {
        window.history.replaceState({page: 'index'}, '', window.location.pathname);
        window.history.pushState({api: firstHash}, '', firstHash);
    }
    $win.scroll(function() {
        if ($nav.css('display') !== 'none') {
            {
                var footerTop = footer.offsetTop;
                var scrollTop = $win.scrollTop();
                var pageHeight = scrollTop + $win.height();
                if (footerTop >= scrollTop && footerTop < (pageHeight)) {
                    var footViewHeight = pageHeight - footerTop;
                    $bar.css(heightProperty, 'calc(100vh - ' + (topBottomHeight + footViewHeight) + 'px)');
                } else {
                    var htmlViewHeight = (html.clientHeight - topBottomHeight) + 'px';
                    if ($bar.css(heightProperty) !== htmlViewHeight) {
                        $bar.css(heightProperty, 'calc(100vh - ' + topBottomHeight + 'px)');
                    }
                }
            }


            {
                if (firstScroll) {
                    firstScroll = false;
                    window.history.pushState({api: ''}, '', '');
                }
                var hash = $nav.find('.active > a:last').attr('href');
                if (hash !== window.location.hash) {
                    if (hash === undefined || hash === null || hash === '') {
                        window.history.replaceState({api: 'index'}, '', window.location.pathname);
                    } else {
                        window.history.replaceState({api: hash}, '', hash);
                    }
                }
            }
        }
    });
});
</script>

<script src="//cdn.bootcss.com/dot/1.1.2/doT.min.js"></script>
<script type="text/javascript">
/* data: page info */
function isBlank(str) {
    return str === undefined || str === null || str === 'undefined' || str === 'null' || str === '';
}
function isNotBlank(str) {
    return !isBlank(str);
}
function addLine(html) {
    if (isBlank(html)) {
        return '';
    }

    var lineNum = html.split(/\n/).length;
    var lineHtml = '<span class="line-number">';
    var i;
    for (i = 0; i < lineNum; i++) {
        lineHtml += (i + 1) + '\n';
    }
    lineHtml = lineHtml.trim();
    lineHtml += '</span>';
    return lineHtml + html;
}

var locationDomain = window.location.protocol + '//' + window.location.host;
if (isNotBlank(projectDomain) && locationDomain !== projectDomain && !projectDomain.startsWith(locationDomain + '/')) {
    $.ajaxSetup({
        crossDomain: true,
        xhrFields: { withCredentials: true }
    });
}
var $main = $('.col-md-9');
$.get(projectDomain + '/api/info').done(function(data) {
    if (isNotBlank(data)) {
        var documentInfo;
        if (typeof data === 'string') {
            documentInfo = JSON.parse(data);
        } else {
            documentInfo = data;
        }


        {
            var copyright = documentInfo.copyright;
            if (isBlank(copyright)) {
                return;
            }
            if (isNotBlank(copyright.title)) {
                $('title').html(copyright.title);
            }
            var $copyrightRender = $('#copyright');
            var template = doT.template($copyrightRender.html());
            $copyrightRender.parent().html(template(copyright));
        }


        {
            var doc = documentInfo.document;
            if (isBlank(doc)) {
                return;
            }
            var $urlRender = $('#url-render');
            var urlRenderTemplate = doT.template($urlRender.html());
            $urlRender.parent().html(urlRenderTemplate(doc));

            var $navRender = $('#url-nav-render');
            var navRenderTemplate = doT.template($navRender.html());
            $navRender.parent().html(navRenderTemplate(doc));

            $('pre[class="src src-json"]').each(function() {
                var $html = escapeHtml($(this).html());
                var html;
                if (isNotBlank($html)) {
                    html = $html.replace(/(.*?)(\/\*.*?\*\/)/g, '$1<span class="comment">$2</span>');
                } else {
                    html = '<span class="red">响应为空 或 无法解析返回类型</span>';
                }
                $(this).html(addLine(html));
            });

            var hash = window.location.hash;
            if (isNotBlank(hash)) {
                var $anchor = $(hash);
                if ($anchor.length > 0) {
                    var $li = $('a[href="' + hash + '"]').parent();
                    $li.addClass('active');
                    $li.parent().parent().addClass('active');
                    $('html,body').animate({scrollTop: $anchor.offset().top}, 0);
                }
            }
        }
    } else {
        $main.html('<span class="red">无接口信息</span>');
    }
}).fail(function() {
    $main.html('<span class="red">接口请求错误</span>');
});

function escapeHtml(html) {
    return isBlank(html) ? null : html.replace(/</g, '&lt;').replace(/>/g, '&gt;');
}
</script>
</body>
</html>
